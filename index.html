<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cronômetro com Motivo e Resumo</title>
  <style>
    /* ... Estilos existentes ... */
    canvas {
      max-width: 100%;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <h1>Registro de Atividades</h1>
    
    <!-- Cronômetro e motivo -->
    <!-- ... Código existente ... -->

    <!-- Resumo com gráfico -->
    <div class="block">
      <h2>Resumo</h2>
      <div id="summary"></div>
      <canvas id="summaryChart"></canvas>
    </div>
  </div>

  <script>
    // ... Código do cronômetro e registros ...

    // Atualiza o resumo e o gráfico
    function updateSummary(records) {
      const summary = records.reduce((acc, record) => {
        acc[record.motivo] = (acc[record.motivo] || 0) + convertTimeToSeconds(record.tempo);
        return acc;
      }, {});

      // Ordena o resumo por tempo decrescente
      const sortedSummary = Object.entries(summary).sort((a, b) => b[1] - a[1]);

      // Exibe o resumo em texto
      summaryDiv.innerHTML = sortedSummary
        .map(([motivo, seconds]) => `<p>${motivo}: ${convertSecondsToTime(seconds)}</p>`)
        .join("");

      // Gera o gráfico com Chart.js
      const labels = sortedSummary.map(([motivo]) => motivo);
      const data = sortedSummary.map(([_, seconds]) => seconds / 60); // Converte para minutos para visualização

      const ctx = document.getElementById('summaryChart').getContext('2d');
      if (window.summaryChart) {
        window.summaryChart.destroy();
      }
      window.summaryChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: 'Tempo em minutos',
            data,
            backgroundColor: 'rgba(54, 162, 235, 0.6)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Tempo (minutos)'
              }
            }
          },
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    // ... Código para exportar para Excel e carregar registros ...
  </script>
</body>
</html>
